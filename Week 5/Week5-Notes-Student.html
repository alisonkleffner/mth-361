<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>MTH361: Probability and Statistics in the Health Sciences</title>
    <meta charset="utf-8" />
    <meta name="author" content="The Normal Distribution" />
    <meta name="date" content="2023-09-12" />
    <script src="libs/header-attrs-2.23/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# MTH361: Probability and Statistics in the Health Sciences
]
.author[
### The Normal Distribution
]
.date[
### September 12, 2023
]

---




### Agenda

- Probability distribution
- Random variable
- Normal distribution
- Properties of the Normal distribution
- Finding percentiles/quantiles from a Normal Distribution
- How do we know if a variable follows a Normal Distribution

---
### Announcements

+ Homework 3 due tonight at 11:59 pm!
+ Homework 4 due Tuesday September 19 at 11:59 pm
+ Lab 4 on Thursday, due Friday September 15 at 11:59 pm


**Today**: Section 3.3

---
# Notes

Homework 2: Typical Range is `\(\mu \pm \sigma\)` (see "one numerical variable" section of visualization notes)

Lab 3: 
+ Question 3: Is having excellent health and no health coverage independent? - Must use multiplication rule
+ Question 7: Draw a Venn Diagram!
  - What percent of Americans live above the poverty line and only speak English at home? 68.9 (color overlap)

&lt;img src="../images/Week5/7d.png" width="40%" style="display: block; margin: auto;" /&gt;
+ Question 4/6/8: Follow along with "Lupus" Example (posted in Blueline)

---
### Random Variables


- Last week, we have talked about the probability of an event. e.g., let C be the even that a person is diagnosed with Cancer, we have P(C).
- Now suppose we have three people, and we are wondering what is the probability that exactly one of them is diagnosed with Cancer.
- You can either calculating the sum of all possible events, or use a random variable
- **Random variable** is a **function** that maps events to real numbers (or high dimensional real space)
- Let random variable X be the number of people diagnosed with Cancer, then the question is asking what is P(X = 1)

---
### Random Variables

If a Coin is tossed three times, the outcome is a sequence of observed heads and tails

&lt;img src="../images/Week5/randon-variable-heads.png" width="70%" style="display: block; margin: auto;" /&gt;

The figure shows the possible outcomes when a coin is tossed three times. 
`\(\\\)`
Here, `\(X\)` is the number of heads for the three tosses.

---
### Probability Distribution

Probability distribution: a list of the probabilities of all mutually exclusive outcomes of random variable

Based on the potential outcomes of a random variable, we can classify random variables and their distribution into continuous and discrete. e.g., 
  + The number of people enter the clinic 
  + The proportion of people recovered with the new drug
  
For discrete random variable, its probability distribution is called probability mass function (p(y))

For continuous random variable, its probability distribution is called probability density function (f (y))

---
### Probability Distribution

&lt;img src="../images/Week5/probability-distribution-heads.png" width="70%" style="display: block; margin: auto;" /&gt;

Rules:

+ Outcomes must be mutually exclusive
+ Each probability must be between 0 and 1
+ Probabilities must sum to 1


---
### Example: Let's Start with an Example

The forced expiratory volume (FEV, measured in liters) is a primary indicator of successful lung function and corresponds to the volume of air that can be forcibly be blown out in the first second after fully breathing in. A study of FEV on a sample of n = 654 children measured the children’s age, FEV, height, sex, and whether they had been exposed to second-hand smoke.
&lt;br&gt;
Let’s see the distribution of FEV and height.

.pull-left[
![](Week5-Notes-Student_files/figure-html/unnamed-chunk-5-1.png)&lt;!-- --&gt;

].pull-right[
![](Week5-Notes-Student_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;

]

---
### Normal Distribution

+ Both variables’ distribution is a “bell-shaped curve”. 
+ **Normal Distribution**: the probability distribution that generates a perfect “bell-shaped curve”
  - A continuous probability distribution (any value in an interval is possible) that always describes a symmetric, bell-shaped curve with two parameters: mean `\((\mu)\)` and standard deviation `\((\sigma)\)`.
  - Notation: `\(N(\mu, \sigma)\)` 


&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-7-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---
### Properties of the Normal Model

- Symmetric and unimodal about the mean `\(\mu\)`
- Probability distribution is highest at exactly `\(\mu\)`
- The standard deviation `\(\sigma\)` controls the spread the distribution

&lt;img src="../images/Week5/normal-dist.png" width="1501" style="display: block; margin: auto;" /&gt;

---

### Relationship between Density and Probability

- Density is not probability
- The area under the probability density function is 1
- Probability is measured by the area under the curve. e.g., the shaded area in the figure represents the P(−2 &lt; X &lt; 0)
- Note: For a continuous variable, at any point x, P(X = x) = 0

&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-9-1.png" width="55%" style="display: block; margin: auto;" /&gt;


---
### Finding Normal Probabilities

The probability distribution for the normal distribution is:

`$$f(x) = \frac{1}{\sqrt{2\pi\sigma^2}}e^{−(x−μ)^2/2\sigma^2}$$`

How do we find the area under it?

 + Traditional chart reading with Z score
 + Use R as a calculator
 
 
---
### Z-Score

- Comparing and calculating values across different normal distributions can be tricky.
- One of the solution is to convert all normal distribution with different mean and standard deviation to a standard normal distribution.
- For a random normal distribution, we can always define a new random variable Z, such that `$$Z = \frac{X − \mu}{\sigma},$$` then Z will follow a standard normal distribution with mean equal to 0 and standard deviation equals to 1.


**Essentially**: if `\(X \sim N(\mu, \sigma^2) \text{ then }  Z = \frac{X − \mu}{\sigma} \sim N(0,1)\)` 

  - [Proof](https://online.stat.psu.edu/stat414/lesson/16/16.2)

---
### Z-Score

- Quantifies how far the observation is from the mean, in units of standard deviation
- Observations above the man have positive Z-scores, while observations below the mean have negative Z-scores.

&lt;img src="../images/Week5/standard-normal.png" width="70%" height="70%" style="display: block; margin: auto;" /&gt;

---
### Standard Normal Distribution

The Standard Normal `\((N(0,1))\)` distribution is well-studied

We have a z-score chart that records all the probabilities of the standard normal distribution from `\(-\infty\)` to a certain value ([link to chart](https://www.z-table.com/)). 

.pull-left[
&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-11-1.png" width="85%" style="display: block; margin: auto;" /&gt;
].pull-right[
&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-12-1.png" width="85%" style="display: block; margin: auto;" /&gt;
]

If you want to calculate `\(P( a &lt; X &lt; b)\)`, then $$ P( a &lt; X &lt; b) = P( -\infty &lt; X &lt; b) = P( -\infty &lt; X &lt; a)$$

---
### Application: FEV

Assume forced expiratory volume (FEV) follows a normal model with `\(\mu\)` = 2.64 and `\(\sigma\)` = 0.87. Find the probability that a child has FEV less than 1.5. First let's calculate the z-score.

---
### Application: FEV

Assume forced expiratory volume (FEV) follows a normal model with `\(\mu\)` = 2.64 and `\(\sigma\)` = 0.87. Find the probability that a child has FEV less than 1.5.



In the `mosaic` package in R, we have a function called `xpnorm`


```r
xpnorm(q=1.5, mean = 2.64, sd=0.87)
```

&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-14-1.png" width="40%" style="display: block; margin: auto;" /&gt;

```
## [1] 0.0950396
```

---
### Application: Birth Weights

The babies born in single births in the United States have birth weights that are approximately normally distributed with mean 3.3 kg and standard deviation 0.56 kg.

- What is the probability of a baby with a born weight between 3 kg and 4 kg?
- What is the probability of a baby with a born weight more than 5 kg?

---
### Probability of a baby with a born weight between 3 kg and 4 kg?


---
### Probability of a baby with a born weight more than 5 kg?


---
### Your Turn: Spy Height

It was rumored that Britain’s domestic intelligence service MI5 has an upper limit on the height of its spies, on the assumption that tall people stand out. (For the record - they deny this.) The rumor says that, to apply to be a spy, you can be no taller than 5 feet 11 inches (180.3 cm) if you are a man, and no taller than 5 feet 8 inches (172.7 cm) if you are a woman – supposedly to allow the spies to blend in with a crowd. Adult heights are known to be approximately normally distributed. For males, x ∼ N(177.0, 7.1) and for females, x ∼ N(163.3, 6.4).

+ What proportion of British males are eligible to apply to MI5?
+ What proportion of British females are eligible to apply to MI5?

Sketch a graph of both distributions to help you out.

---
### Your Turn: Spy Height

.pull-left[
What proportion of British males are eligible to apply to MI5?



].pull-right[
What proportion of British females are eligible to apply to MI5?

]


---
### Empirical Rule

A simple rule for working with the normal model is the Empirical Rule:

- Approximately 68% of all probability in a normal model is within `\(\mu \pm \sigma\)`
- Approximately 95% of all probability in a normal model is within `\(\mu \pm 2\sigma\)`
- Approximately 99.7% of all probability in a normal model is within `\(\mu \pm 3\sigma\)`

&lt;img src="../images/Week5/empirical rule.png" width="1605" style="display: block; margin: auto;" /&gt;


---
### Application: Birth Rate

The babies born in singleton births in the United States have birth weights that are approximately normally distributed with mean 3.296 kg and standard deviation 0.560 kg.

+ Give a range for the central 68% of all birth weights.
+ Give a range for the central 95% of all birth weights.
+ Give a range for nearly all birth weights (99.7%).

---
### Find the quantile for a random probability

What if the question is asking about a random probability?

To convert a value from the standard normal curve (Z) to one on the normal distribution `\(N(\mu, \sigma)\)`: `$$X = \mu + Z\sigma$$`

---
### Find the quantile for a random probability

Assume FEV follows a normal model with `\(\mu\)` = 2.64 and `\(\sigma\)` = 0.87. Find the lung capacity of the lowest 40% of children.

--

```r
xqnorm(0.40, mean=2.64, sd=0.87)
```

&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-16-1.png" width="45%" style="display: block; margin: auto;" /&gt;

```
## [1] 2.419588
```
---
### Your Turn: Birth Rate

The babies born in singleton births in the United States have birth weights that are approximately normally distributed with mean 3.296 kg and standard deviation 0.560 kg.

+ Find the birth rate of the lowest 20% of babies
+ Find the birth rate of the highest 40% of babies


---
### Does the data ”fit” a normal model?

The normal distribution can be used to approximate other distributions, such as the binomial distribution. In order to continue with using the normal distribution, we must test the appropriateness of this assumption

+ **QQ plot**: a quantile-quantile plot plots the sample values from our data against the corresponding ”theoretical quantiles” from a normal distribution using converted z-scores
+ The closer the QQ plot is to a straight line, the better our data ”fits” a normal model.
+ No QQ plot will be exactly perfect. Look for obvious deviations!

---
### What to expect in a QQ plot

The data sets below were all generated using a N(0, 1) model.

&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-17-1.png" style="display: block; margin: auto;" /&gt;

---
### What to expect in a QQ plot

The data sets below were all generated using a N(0, 1) model.

&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /&gt;



---
### What to expect in a QQ plot

What happens when we have clearly non-normal data sets?


&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /&gt;


---
### What to expect in a QQ plot

What happens when we have clearly non-normal data sets?

&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-20-1.png" style="display: block; margin: auto;" /&gt;


---
### Application: Height

Would it be reasonable to model height of children using a normal distribution?

.pull-left[
&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-21-1.png" style="display: block; margin: auto;" /&gt;

].pull-right[
&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-22-1.png" style="display: block; margin: auto;" /&gt;
]
---
### Application: Height
Would it be reasonable to model height of children using a normal distribution?

&lt;img src="Week5-Notes-Student_files/figure-html/unnamed-chunk-23-1.png" style="display: block; margin: auto;" /&gt;


```


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
