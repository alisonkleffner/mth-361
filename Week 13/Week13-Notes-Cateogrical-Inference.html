<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>MTH361: Probability and Statistics in the Health Sciences</title>
    <meta charset="utf-8" />
    <meta name="author" content="Inference for Categorical Data" />
    <meta name="date" content="2023-11-14" />
    <script src="libs/header-attrs-2.23/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# MTH361: Probability and Statistics in the Health Sciences
]
.author[
### Inference for Categorical Data
]
.date[
### November 14, 2023
]

---







### Announcements



---
### Proportions

**Proportion**: the fraction of the total that possesses a certain attribute.

- Eg: percentage of junior student in this class.

--

**Example**: Advanced melanoma is an aggressive form of skin cancer that, until recently, was almost uniformly fatal. Two therapies have seemed to be successful in triggering an immune response to this cancer: nivolumab and ipilimunab.

A 2013 report in the New England Journal of Medicine by Wolchok et al. reported the results of a study in which patients were treated with both nivolumab and ipilimumab. Fifty-three patients were given the new regimens concurrently, and the response to therapy could be evaluated in
52 of the 53. Of the 52 evaluable patients, 21 (40%) experienced a response according to commonly accepted criteria. In previous studies, the proportion of patients responding to one of these agents was 30% or less.

How might one compare the new data to past results?

---
### Binomial Data

**Binomial variable**: a variable with only two possible outcomes (also called binary variables)


The possible outcomes are referred to as successes (the outcome we care about) and failures (the outcome we don’t).

When we have a binomial variable, our goal is usually to estimate the underlying probability of success, or population proportion, `\(p\)`.

As usual, we cannot know the true value of a population parameter but we can take a sample statistics `\(\hat{p}\)` to estimate the true value (like how we estimate `\(\mu\)` with `\(\bar{x}\)`).

---
### Sampling Distribution of `\(\hat{p}\)`

The sampling distribution of `\(\hat{p}\)` with sample size *n* has:

- Mean: p
- Standard Error: `$$SE_{\hat{p}} = \sqrt{\frac{p(1-p)}{n}}$$`
- Shape: Approximately normally distributed, as long as the sample size is "large enough"
  + `\(np \geq 10\)`
  + `\(n(1-p) \geq 10\)`

We can calculate confidence intervals and carry out hypothesis tests using this approximation, but ... what if we want to be more accurate?

So instead, we'll use methods based on the **binomial distribution**

---
### Binomial Distribution

Assuming each observation is independent, we can get the formula for the binomial distribution from the Multiplication Rule. Let `\(P(X = x)\)` represent the probability that we have observed *x* successes out of *n* trials.

`$$P(X=x)={n \choose x}p^{x}(1-p)^{n-x}$$`

--

Notice that binomial distribution is a discrete distribution since x can only be integers.

---
### Binomial Distribution

What does the binomial distribution “look like”? It depends on the parameters (*p* and *n*).

&lt;img src="Week13-Notes-Cateogrical-Inference_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;

---
### Let's Remember our Example

Advanced melanoma is an aggressive form of skin cancer that, until recently, was almost uniformly fatal. Two therapies have seemed to be successful in triggering an immune response to this cancer: nivolumab and ipilimunab.

A 2013 report in the New England Journal of Medicine by Wolchok et al. reported the results of a study in which patients were treated with both nivolumab and ipilimumab. Fifty-three patients were given the new regimens concurrently, and the response to therapy could be evaluated in
52 of the 53. Of the 52 evaluable patients, 21 (40%) experienced a response according to commonly accepted criteria. In previous studies, the proportion of patients responding to one of these agents was 30% or less.

How might one compare the new data to past results?

---
### Binomial test

_Step 1: Write the null and alternative hypotheses_

Assume that the true population proportion `\(p=p_0\)`, where `\(p_0\)` is some constant value. The hypotheses we’re interested in testing are:

`$$H_0: p = p_0$$`

`$$H_A: p (&lt;, &gt;, \ne) p_0$$`

--

Hypotheses for our test:

`$$H_0: p = 0.3$$`

`$$H_A: p &gt; 0.3$$`



---
### Binomial test 

_Step 2: Identify the test statistic_

The data we'll need from our sample is the number of successes `\(x\)` and the sample size `\(n\)`.

_Step 3: Calculate the `\(p\)`-value_

We’ll use the binomial distribution with `\(p=p_0\)` to calculate the `\(p\)`-value.


1. Build a binomial distribution based on `\(H_0: p = p_0\)`.

2. Calculate the probability of observing a "more extreme" result using this binomial distribution.

---
### Binomial test

We have two "test statistics": the number of patients who improved (`x=21`), and the number of trials (`n=52`).

![](Week13-Notes-Cateogrical-Inference_files/figure-html/unnamed-chunk-4-1.png)&lt;!-- --&gt;

What's the probability that 21 patients or more would improve, __if the true improvement rate is 30%__?

---
### Binomial test

Instead of calculating probabilities directly, we can use a function in R called `binom.test()`.


```r
binom.test(x=21, n=52, p=0.30, alternative='greater')
```

```
## 
## 	Exact binomial test
## 
## data:  21 and 52
## number of successes = 21, number of trials = 52, p-value = 0.07167
## alternative hypothesis: true probability of success is greater than 0.3
## 95 percent confidence interval:
##  0.2889045 1.0000000
## sample estimates:
## probability of success 
##              0.4038462
```

---
### Binomial test

_Step 4: Make a conclusion to the research question_
  
- There may be _strong_ evidence to reject `\(H_0\)` if `\(p-value &lt; \alpha\)`.
- There may _not_ be evidence to reject `\(H_0\)` if `\(p-value &gt; \alpha\)`.


Remember that sample size, data quality, choice of `\(\alpha\)`, and consequences matter!


---
### Example: 

.bg-washed-blue.b--blue.ba.ph3[
__Example__: Male radiologists have long suspected that they tend to have fewer sons than daughters. In a random sample of 87 children of "highly irradiated" male radiologists, 30 were male. Assume that the population proportion of male births is 0.519 (in the human population male babies are slightly more likely than female babies). Is there significant evidence to show male radiologists are less likely to have male babies?
]

1. Write the null and alternative hypothesis
2. What is the test statistic in this case
3. Make a conclusion based on the `\(R\)` output

```r
binom.test(x=30, n=87, p=0.519, alternative='less')
```

```
## 
## 	Exact binomial test
## 
## data:  30 and 87
## number of successes = 30, number of trials = 87, p-value = 0.0007905
## alternative hypothesis: true probability of success is less than 0.519
## 95 percent confidence interval:
##  0.0000000 0.4374992
## sample estimates:
## probability of success 
##              0.3448276
```





    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
